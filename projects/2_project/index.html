<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Image Geolocation | Satyanarayana Chillale </title> <meta name="author" content="Satyanarayana Chillale"> <meta name="description" content="Predicting geographic coordinates from images using hierarchical clustering and retrieval augmented generation."> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://satyanarayanachillale.github.io/projects/2_project/"> <script src="/assets/js/theme.js?9a0c749ec5240d9cda97bc72359a72c0"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Satyanarayana</span> Chillale </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item active"> <a class="nav-link" href="/projects/">projects <span class="sr-only">(current)</span> </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv </a> </li> <li class="nav-item "> <a class="nav-link" href="/teaching/">teaching </a> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="ti ti-search"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Image Geolocation</h1> <p class="post-description">Predicting geographic coordinates from images using hierarchical clustering and retrieval augmented generation.</p> </header> <article> <p><a href="https://satyachillale.github.io/assets/pdf/CV_project_image_geolocation_final.pdf" rel="external nofollow noopener" target="_blank">[Project Paper]</a> <a href="https://satyachillale.github.io/assets/pdf/Image-Geolocation.pdf" rel="external nofollow noopener" target="_blank">[Presentation]</a> <a href="https://github.com/satyachillale/g3-gg" rel="external nofollow noopener" target="_blank">[Code]</a></p> <h3 id="introduction">Introduction</h3> <p>As computer vision systems scale to a global level, one particularly exciting challenge emerges: automatically determining precise geographic coordinates from a single image. Not only can such geolocation models be beneficial for navigation or environmental monitoring, but they can also tackle problems like crime tracking and disaster response. The main hurdle is reconciling the sheer diversity of landscapes worldwide with robust machine learning workflows that can handle large-scale datasets spanning millions of images.</p> <h3 id="clip-meets-geolocation">CLIP Meets Geolocation</h3> <p>A key step forward comes from CLIP-like architectures that align images and text in a shared embedding space. Recent research proposes expanding CLIP by adding a specialized GPS encoder to represent latitude-longitude pairs in high-dimensional embeddings. This approach, often referred to as GeoCLIP, allows continuous geographic coordinates (instead of discrete classes) to co-exist with images and textual information. By training the model to retrieve the matching GPS encoding for a given test image, GeoCLIP demonstrates accurate results for images taken almost anywhere on Earth. Yet, straightforward retrieval from a large, flat collection of GPS points can quickly become infeasible. Searching every coordinate in a gallery of 100K or more points is computationally expensive. This has led researchers to explore hierarchical structures to narrow down candidate regions, simulating how a human might first guess a continent or country and then progressively “zoom in” on a more precise area.</p> <h3 id="hierarchical-feature-clustering">Hierarchical Feature Clustering</h3> <p>To address the computational bottleneck, one promising solution is hierarchical feature clustering at multiple scales. Instead of lumping all GPS coordinates into a single pool, the approach organizes them into clusters at different geographic levels—continent, country, or city. Each cluster corresponds to a centroid representing coordinates that are geographically and visually similar. During inference, the query image embedding is compared only against top-level centroids. Once the model identifies the most similar cluster, it moves to the sub-clusters in that region to further refine the search. By mimicking coarse-to-fine localization, this technique can cut down the number of comparisons by 100x while still preserving a high level of accuracy. It also allows flexibly adding more layers to the tree structure for very large datasets or for extremely fine-grained local predictions like neighborhoods or streets.</p> <h3 id="retrieval-augmented-generation-rag">Retrieval-Augmented Generation (RAG)</h3> <p>While pure retrieval-based methods are great for speed, they sometimes struggle with ambiguous images—think of uniform landscapes like deserts or unremarkable city blocks. Retrieval-Augmented Generation (RAG) tackles this challenge by leveraging large language models (LLMs). First, the system retrieves the top candidate locations from its hierarchical gallery. Then, an LLM such as GPT-4o or Mistral reasons about these candidates and suggests refined or alternate coordinates. This can be especially useful when there are text-based cues (like signs or landmarks) that can help the model disambiguate visually similar areas. When tested on geolocation benchmarks like IM2GPS3K, combining hierarchical retrieval with LLM-based generation produced more robust predictions, particularly for regions with visually similar terrains. The system can also include specific metadata like neighborhood names or local landmarks to further guide the LLM and improve street-level accuracy.</p> <h3 id="results">Results</h3> <p>Experiments show that: Hierarchical clustering can reduce inference costs significantly while maintaining competitive accuracy compared to flat retrieval methods. For instance, clustering the gallery into around 800 groups is enough to capture broad geographical distinctions with minimal loss in precision. RAG inference with a capable LLM often performs better than purely retrieval-based approaches, particularly for ambiguous or underrepresented cases, boosting accuracy at narrower distance thresholds. Fine-grained text embeddings, such as neighborhood-focused prompts, enhance the model’s ability to differentiate locations that look visually similar from a distance but are in different parts of a city or region. When tested on large datasets like MP16-Pro, the combination of a powerful image encoder (e.g., a ViT-based CLIP) and a well-tuned GPS encoder achieves strong performance across multiple geographic levels. The model also benefits substantially from an efficient data pipeline, such as precomputing embeddings and streaming data on the fly during training.</p> <h3 id="samples">Samples</h3> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/geolocation_samples-480.webp 480w,/assets/img/geolocation_samples-800.webp 800w,/assets/img/geolocation_samples-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/geolocation_samples.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="example image" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Two samples from the IM2GPS3K dataset. For each image, we provide the actual location, the final predicted location, and the RAG-based inference predictions using different numbers of candidate references supplied to the large multimodal models (LMMs). </div> <h3 id="future-directions">Future Directions</h3> <p>Looking ahead, there are several avenues for continued improvement:</p> <ul> <li> <p>Deeper Hierarchies: Instead of just two clustering levels, one could extend this to three or four levels to handle extremely large galleries and zoom down to very specific coordinates with minimal overhead.</p> </li> <li> <p>Fine-Grained Language Cues: Incorporating textual clues (think city landmarks or neighborhoods) into the embedded representation can help in densely populated and architecturally diverse areas.</p> </li> <li> <p>Scaling Up: For truly global applications, we might consider galleries of over a million coordinates. The hierarchical approach is well suited to this scenario, though additional techniques (such as beam search) might be required for further efficiency.</p> </li> <li> <p>Generation-Based Refinements: Using techniques from advanced generative models or diffusion models can augment training data for poorly represented locations, and large language models can act as “validators” to refine final predictions.</p> </li> </ul> <p>By uniting large-scale visual encoders with hierarchical clustering and retrieval-augmented generation, we can significantly improve image geolocation systems and bring them closer to solving real-world applications—from next-level gaming to humanitarian goals.</p> </article> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2025 Satyanarayana Chillale. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="external nofollow noopener">Unsplash</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js?a0db7e5d5c70cc3252b3138b0c91dcaf" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/assets/js/mathjax-setup.js?a5bb4e6a542c546dd929b24b8b236dfd"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script defer src="/assets/js/progress-bar.js?2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> <script type="module" src="/assets/js/search/ninja-keys.min.js?a3446f084dcaecc5f75aa1757d087dcf"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script src="/assets/js/search-setup.js?6c304f7b1992d4b60f7a07956e52f04a"></script> <script src="/assets/js/search-data.js"></script> <script src="/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> </body> </html>